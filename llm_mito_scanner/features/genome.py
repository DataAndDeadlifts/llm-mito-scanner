# AUTOGENERATED! DO NOT EDIT! File to edit: ../../nbs/00_breakdown-genome-to-fasta.ipynb.

# %% auto 0
__all__ = ['break_genome_into_fasta_files', 'validate_written_genome_fasta_files']

# %% ../../nbs/00_breakdown-genome-to-fasta.ipynb 3
from pathlib import Path
from Bio import SeqIO
import sqlite3
from yaml import safe_load
from tqdm.auto import tqdm

# %% ../../nbs/00_breakdown-genome-to-fasta.ipynb 8
def break_genome_into_fasta_files(
    genome_file_path: Path, 
    write_path: Path,
):
    """
    Insert the fasta-annotated sequence records from our reference genome 
    into our sqlite3 database.
    """
    for i, seq_record in enumerate(tqdm(SeqIO.parse(genome_file_path, "fasta"))):
        seq_record_write_path = write_path / f"{seq_record.id}.fasta"
        if not seq_record_write_path.exists():
            with seq_record_write_path.open("w+") as out:
                SeqIO.write([seq_record], out, "fasta")

# %% ../../nbs/00_breakdown-genome-to-fasta.ipynb 10
def validate_written_genome_fasta_files(
    write_path: Path
) -> int:
    unlinked_files = 0
    for file in write_path.glob("*.fasta"):
        if file.stat().st_size == 0:
            file.unlink()
            unlinked_files += 1
    return unlinked_files
